<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìŠ¤ì¼€ì¼ ì—°ìŠµ í”„ë ›ë³´ë“œ (22í”„ë ›/í”„ë ›ì‚¬ì´/í’€ìŠ¤ì¼€ì¼)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { background: #f7fafc; font-family: 'Pretendard','Segoe UI',Arial,sans-serif; margin:0; transition:background 0.3s, color 0.3s;}
    body.dark { background: #212334; color: #ebe6f7; }
    .container { max-width:1180px; margin:28px auto; }
    h1 { text-align:center;margin:14px 0 16px 0; position: relative;}
    .controls { display:flex; gap:18px; flex-wrap:wrap; justify-content:center; margin-bottom:18px;}
    select,.switch{background:#eaf6fc;border:none;border-radius:18px;padding:8px 18px;font-size:1.02rem;transition:background 0.3s;}
    body.dark select, body.dark .switch{background:#324360;color:#fff;}
    .scales{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-bottom:16px;max-width:1000px;margin-left:auto;margin-right:auto;}
    .scale-btn{border:none;background:#ffe6ed;color:#7766cc;font-size:0.98rem;padding:8.5px 19px 8.5px 19px;border-radius:17px;cursor:pointer;font-weight:700;margin-bottom:6px;}
    .scale-btn.active{background:#d7e8fa;color:#236daa;font-weight:900;transform:scale(1.09);}
    body.dark .scale-btn{background:#361e3a;color:#f7cdfb;}
    body.dark .scale-btn.active{background:#1a2c40;color:#ffc1ea;}
    .fretboard-sample{
      width:1020px; height:190px;background:#f6b720;border-radius:34px;box-shadow:0 4px 19px #dbca90ab;
      position:relative;margin:0 auto 13px auto;padding-left:60px; padding-right:16px; display:flex; align-items:center;
      overflow-x:visible;
      overflow-y:hidden;
    }
    body.dark .fretboard-sample { background:#3a3636; box-shadow:0 4px 19px #000a; }
    .bridge{position:absolute;left:0;top:0;bottom:0;width:60px;background:linear-gradient(99deg,#ac7125 90%,#efbe5a 100%);border-radius:34px 0 0 34px;box-shadow:2px 0 14px #a66b19a5;z-index:3;}
    body.dark .bridge{background:linear-gradient(99deg,#664b18 90%,#c69c6d 100%);}
    .string{position:absolute;height:2.6px;background:#fff;border-radius:2.9px;z-index:2;box-shadow:0px 1px 2.5px #dba72185;}
    body.dark .string{background:#eeeeee8a;}
    .fret-line{position:absolute;top:24px;bottom:24px;width:3.1px;background:#fff;border-radius:2.2px;z-index:3;box-shadow:0 1.5px 2px #bd9a118a;}
    body.dark .fret-line{background:#ccc;}
    .fret-num{position:absolute;top:2px;color:#fff;font-size:13px;font-weight:700;letter-spacing:0.5px;}
    body.dark .fret-num{color:#c7bfce;}
    .inlay-dot{position:absolute;width:15px;height:15px;border-radius:50%;background:#1b1d21;z-index:9;}
    body.dark .inlay-dot{background:#dedede;}
    .note-dot{position:absolute;background:#fff;width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;
        font-size:1em;font-weight:700;color:#e38432;z-index:8;box-shadow:0 2px 8px #bf550631;border:2.5px solid #e7a51c;user-select:text;transition:background 0.3s, color 0.3s;}
    .note-dot.root{background:#f76b6b;color:#fff;border-color:#901f1f;}
    .note-dot:hover{background:#bbc6fa;color:#1e40a3;}
    body.dark .note-dot{background:#332930;color:#d9b36b;border-color:#c99316;}
    body.dark .note-dot.root{background:#cc2d5e;color:#fff;border-color:#ff93b1;}
    body.dark .note-dot:hover{background:#f7eedd;color:#42239a;}
    @media(max-width:1200px){.fretboard-sample{width:98vw;min-width:800px;max-width:100vw;} .container{max-width:98vw;} .scales{max-width:95vw;}}
    @media(max-width:900px){.fretboard-sample{width: 600px;min-width:98vw;} .fret-num{font-size:11px;}}
    @media(max-width:600px){.fretboard-sample{width:412px;min-width:95vw;padding-left:30px;} .note-dot{width:11px;height:11px;font-size:0.64em;}}
    .darkmode-btn{position:absolute;right:24px;top:0; background:#fff7; color:#444; border:none;
      border-radius:17px; padding:7px 22px;font-size:1.04em;cursor:pointer;z-index:333;transition:background 0.3s;}
    body.dark .darkmode-btn{background:#242a42; color:#ffcdfc;}
  </style>
</head>
<body>
<div class="container">
  <h1>
    ìŠ¤ì¼€ì¼ ì—°ìŠµ í”„ë ›ë³´ë“œ 
    <button class="darkmode-btn" id="darkBtn">ğŸŒ™ ë‹¤í¬ëª¨ë“œ</button>
  </h1>
  <div class="controls">
    <select id="instrument"><option value="guitar">ê¸°íƒ€</option><option value="bass">ë² ì´ìŠ¤</option><option value="violin">ë°”ì´ì˜¬ë¦°</option></select>
    <select id="root"></select>
    <select id="noteType" class="switch"><option value="relative">ìƒëŒ€ë„ìˆ˜</option><option value="absolute">ìŒ ì´ë¦„</option></select>
    <select id="scaleSelect" class="switch"></select>
  </div>
  <div class="fretboard-sample" id="fretboard"><div class="bridge"></div></div>
  <small style="display:block;text-align:center;margin-top:12px;color:#b8acc7;font-size:0.96em;">
   
  </small>
</div>
<script>
  const tunings = {
    guitar:["E","A","D","G","B","E"],
    bass:["E","A","D","G"],
    violin:["G","D","A","E"]
  };
  const fretsByInstrument = {guitar:22,bass:22,violin:25};
  const notes=['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'];
  const scales=[
    {name:"Major",intervals:[0,2,4,5,7,9,11]},
    {name:"Natural Minor",intervals:[0,2,3,5,7,8,10]},
    {name:"Harmonic Minor",intervals:[0,2,3,5,7,8,11]},
    {name:"Melodic Minor",intervals:[0,2,3,5,7,9,11]},
    {name:"Dorian",intervals:[0,2,3,5,7,9,10]},
    {name:"Phrygian",intervals:[0,1,3,5,7,8,10]},
    {name:"Lydian",intervals:[0,2,4,6,7,9,11]},
    {name:"Mixolydian",intervals:[0,2,4,5,7,9,10]},
    {name:"Aeolian",intervals:[0,2,3,5,7,8,10]},
    {name:"Locrian",intervals:[0,1,3,5,6,8,10]},
    {name:"Major Pentatonic",intervals:[0,2,4,7,9]},
    {name:"Minor Pentatonic",intervals:[0,3,5,7,10]},
    {name:"Blues",intervals:[0,3,5,6,7,10]},
    {name:"Bebop Major",intervals:[0,2,4,5,7,8,9,11]},
    {name:"Bebop Minor",intervals:[0,2,3,5,7,8,9,10]},
    {name:"Bebop Dominant",intervals:[0,2,4,5,7,9,10,11]},
    {name:"Diminished (Whole-Half)",intervals:[0,2,3,5,6,8,9,11]},
    {name:"Diminished (Half-Whole)",intervals:[0,1,3,4,6,7,9,10]},
    {name:"Whole Tone",intervals:[0,2,4,6,8,10]},
    {name:"Altered",intervals:[0,1,3,4,6,8,10]},
    {name:"Lydian Dominant",intervals:[0,2,4,6,7,9,10]},
    {name:"Double Harmonic",intervals:[0,1,4,5,6,9,10]},
    {name:"Hungarian Minor",intervals:[0,2,3,6,7,8,11]},
    {name:"Neapolitan Major",intervals:[0,1,3,5,7,9,11]},
    {name:"Neapolitan Minor",intervals:[0,1,3,5,7,8,11]},
    {name:"Persian",intervals:[0,1,4,5,6,8,11]}
  ];
  const degreeNames={0:'1',1:'b2',2:'2',3:'b3',4:'3',5:'4',6:'#4',7:'5',8:'b6',9:'6',10:'b7',11:'7',12:'8'};

  // NOTE ì„ íƒ
  function makeSelect(id, values, def){
    const sel = document.getElementById(id);
    sel.innerHTML = values.map(v=>`<option value="${v}">${v}</option>`).join('');
    sel.value = def||values[0];
  }
  makeSelect('root', notes, 'C');

  // ìŠ¤ì¼€ì¼ ë“œë¡­ë‹¤ìš´ ìƒì„±
  const scaleSelect = document.getElementById('scaleSelect');
  scaleSelect.innerHTML = scales.map((s, idx) => `<option value="${idx}">${s.name}</option>`).join('');
  scaleSelect.value = 0;
  scaleSelect.onchange = drawFretboard;

  document.getElementById('instrument').onchange = drawFretboard;
  document.getElementById('root').onchange = drawFretboard;
  document.getElementById('noteType').onchange = drawFretboard;

  // ë‹¤í¬ëª¨ë“œ ë²„íŠ¼
  document.getElementById('darkBtn').onclick = function() {
    document.body.classList.toggle('dark');
    this.textContent = document.body.classList.contains('dark') ? 'â˜€ï¸ ë¼ì´íŠ¸' : 'ğŸŒ™ ë‹¤í¬ëª¨ë“œ';
  };

  // í”„ë ›ë³´ë“œ ê·¸ë¦¬ê¸° í•¨ìˆ˜
  function drawFretboard() {
    const instrument = document.getElementById('instrument').value;
    const root = document.getElementById('root').value;
    const noteType = document.getElementById('noteType').value;
    const scaleIdx = parseInt(document.getElementById('scaleSelect').value, 10);
    const scale = scales[scaleIdx];
    const tuning = tunings[instrument];
    const frets = fretsByInstrument[instrument];
    const fb = document.getElementById('fretboard');
    const fbWidth = 920;
    let fretX = [];
    let fretGap = fbWidth / frets;
    for(let i=0;i<=frets;i++) fretX.push(60+i*fretGap);

    // "ì¤„, ì¸ë ˆì´ ìœ„ì¹˜"ì—ì„œ ì¤„ ë°°ì—´ì„ ë’¤ì§‘ê¸° (ì•„ë˜ìª½ì´ 6ë²ˆì¤„!)
    let strCnt = tuning.length;
    let strGap = 120/(strCnt-1);
    // let strYs = []; for(let s=0;s<strCnt;s++) strYs.push(25+s*strGap);  // ê¸°ì¡´: 1ë²ˆì´ ì•„ë˜, 6ë²ˆì´ ìœ„
    let strYs = []; for(let s=0;s<strCnt;s++) strYs.push(25+(strCnt-1-s)*strGap); // ìˆ˜ì •: 6ë²ˆì´ ì•„ë˜!

    let inlayF = [3,5,7,9,12,15,17,19,21];
    let scaleNotes = scale.intervals.map(i=>notes[(notes.indexOf(root)+i)%12]);
    let scaleMap = {}; scale.intervals.forEach((ival)=>{scaleMap[notes[(notes.indexOf(root)+ival)%12]]=degreeNames[ival];});
    let html = `<div class="bridge"></div>`;

    // ì¤„
    for(let s=0;s<strCnt;s++) html+=`<div class="string" style="top:${strYs[s]}px; left:${fretX[0]}px; width:${fretX[frets]-fretX[0]}px;"></div>`;

    // í”„ë ›
    for(let f=0;f<=frets;f++) html+=`<div class="fret-line" style="left:${fretX[f]}px"></div>`;
    // í”„ë ›ë²ˆí˜¸
    for(let f=1;f<=frets;f++) html+=`<div class="fret-num" style="left:${fretX[f]-10}px">${f}</div>`;
    // ì¸ë ˆì´ ë„íŠ¸: 12, 24í”„ë ›ì€ ì„¸ë¡œë°°ì—´
    let y_inlay = strYs[strCnt-1]+13;
    for(let f=0;f<=frets;f++){
      if(inlayF.includes(f)){
        if(f===12||f===24){
          html+=`<div class="inlay-dot" style="left:${(fretX[f]+fretX[f-1])/2-0.5}px;top:${y_inlay-7}px"></div>`;
          html+=`<div class="inlay-dot" style="left:${(fretX[f]+fretX[f-1])/2-0.5}px;top:${y_inlay+10}px"></div>`;
        }else{
          html+=`<div class="inlay-dot" style="left:${(fretX[f]+fretX[f-1])/2}px;top:${y_inlay}px"></div>`;
        }
      }
    }
    // ìŒí‘œ(ì‚¬ì´ê°’)
    for(let s=0;s<strCnt;s++){
      for(let f=0;f<=frets;f++){
        let fx = (fretX[f]+fretX[f-1])/2;
        if(f === 0){
          fx = fretX[0] - (fretX[1]-fretX[0]);
        }
        if(isNaN(fx)) continue;
        let noteIdx = (notes.indexOf(tuning[s])+f)%12;
        let noteName = notes[noteIdx];
        if(!scaleNotes.includes(noteName)) continue;
        let isRoot = noteName===root;
        let dotText = noteType==='absolute'?noteName:(isRoot?'1':(scaleMap[noteName]||''));
        html+=`<div class="note-dot${isRoot?' root':''}" style="top:${strYs[s]-10}px;left:${fx-12}px;" title="${noteName}">${dotText}</div>`;
      }
    }
    fb.innerHTML = html;
  }
  drawFretboard();
</script>
</body>
</html>
